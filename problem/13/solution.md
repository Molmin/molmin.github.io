从前往后依次处理每个数。用优先队列维护从任意一个已经处理过的数为起点的模值，再用一个变量维护其中所有数的和。

处理一个新的数时，将优先队列中的所有数对这个新数进行取模，并且更新维护数和的变量。再将这个数加入优先队列中，此时这个维护数和的变量值即为以该数为结尾的连续模值之和，加入答案即可。

考虑该算法的时间复杂度。每个数每次取模后，至多变为本身的一半，故每个数至多被取模 $\log a_i$ 次。带上优先队列 $\Theta(\log n)$ 的时间复杂度，该算法时间复杂度为 $\Theta(n\cdot\log n\cdot\log a)$。
